
{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
  <h3 class="text-primary mb-3">Edit User</h3>

  <form method="post" class="row g-2 border rounded p-3 bg-light shadow-sm">
    <div class="col-md-4">
      <label class="form-label">Link Employee (optional)</label>
      <select name="employee_id" class="form-select">
        <option value="">-- none --</option>
        {% for e in employees %}
          <option value="{{ e.id }}" {% if user.employee_id == e.id %}selected{% endif %}>
            {{ e.last_name }}, {{ e.first_name }} {{ e.middle_name or '' }} â€” {{ e.designation or 'Staff' }}
            {% if e.status != 'active' %}(archived){% endif %}
          </option>
        {% endfor %}
      </select>
    </div>

    <div class="col-md-3">
      <label class="form-label">Username *</label>
      <input type="text" name="username" class="form-control" value="{{ user.username }}" required>
    </div>

    <div class="col-md-2">
      <label class="form-label">Role *</label>
      <select name="role" class="form-select" required>
        {% for r in ALLOWED_ROLES %}
          <option value="{{ r }}" {% if user.role == r %}selected{% endif %}>{{ r|capitalize }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="col-md-2">
      <label class="form-label">Status</label>
      <select name="status" class="form-select">
        <option value="active" {% if user.status=='active' %}selected{% endif %}>Active</option>
        <option value="archived" {% if user.status=='archived' %}selected{% endif %}>Archived</option>
      </select>
    </div>

    <div class="col-md-4">
      <label class="form-label">Reset Password (optional)</label>
      <input type="password" name="new_password" class="form-control" placeholder="Enter new password to reset">
      <div class="form-text">Leave blank to keep current password.</div>
    </div>

    <div class="col-12 d-flex gap-2 mt-2">
      <button class="btn btn-primary">Save Changes</button>
      <a href="{{ url_for('manage_users') }}" class="btn btn-outline-secondary">Back</a>
    </div>
  </form>
</div>
{% endblock %}
